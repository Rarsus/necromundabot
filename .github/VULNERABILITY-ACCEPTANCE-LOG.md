# Vulnerability Acceptance Log

**Purpose**: Track all accepted vulnerabilities with explicit exemption periods and re-evaluation dates.

**Source of Truth**: [.github/audit-baseline.json](./audit-baseline.json) (run `npm run sync:vulnerabilities` to regenerate this file)

**Last Updated**: 2026-01-29

**Last Generated**: 2026-01-29T12:32:42.085Z

---

## Summary

| Metric                  | Value      |
| ----------------------- | ---------- |
| **Total Accepted**      | 13         |
| **HIGH Severity**       | 5          |
| **MODERATE Severity**   | 3          |
| **Critical Exemptions** | 4          |
| **Next Review**         | 2026-04-01 |
| **Critical Expires**    | 2026-05-01 |

---

## Exemption Expiration Schedule

| CVE                 | Package | Severity | Expires    | Days | Status      |
| ------------------- | ------- | -------- | ---------- | ---- | ----------- |
| GHSA-5j98-mcp5-4vw2 | glob    | HIGH     | 2026-03-31 | 61   |             |
| GHSA-6hxm-7r2w-pxwj | undici  | HIGH     | 2026-05-01 | 92   | üî¥ CRITICAL |
| GHSA-6hxm-7r2w-pxwj | undici  | HIGH     | 2026-05-01 | 92   | üî¥ CRITICAL |
| GHSA-6hxm-7r2w-pxwj | undici  | HIGH     | 2026-05-01 | 92   | üî¥ CRITICAL |
| GHSA-6hxm-7r2w-pxwj | undici  | HIGH     | 2026-05-01 | 92   | üî¥ CRITICAL |
| GHSA-5p8v-58qm-c7m8 | tar     | MODERATE | 2026-05-31 | 122  |             |
| GHSA-5p8v-58qm-c7m8 | tar     | MODERATE | 2026-05-31 | 122  |             |
| GHSA-5p8v-58qm-c7m8 | tar     | MODERATE | 2026-05-31 | 122  |             |

---

## Current Accepted Vulnerabilities (13 Total)

### HIGH Severity (5 vulnerabilities)

#### 1. GHSA-6hxm-7r2w-pxwj - undici

üî¥ **CRITICAL EXEMPTION**

| Property              | Value                                                                                                                                                                                                                                 |
| --------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **CVE**               | GHSA-6hxm-7r2w-pxwj                                                                                                                                                                                                                   |
| **Package**           | undici                                                                                                                                                                                                                                |
| **Severity**          | HIGH                                                                                                                                                                                                                                  |
| **Status**            | ‚úÖ ACCEPTED                                                                                                                                                                                                                           |
| **Type**              | Decompression Bomb / Unbounded Decompression                                                                                                                                                                                          |
| **Description**       | Improper input validation allows unbounded decompression of gzip/deflate/brotli streams without size limits, enabling memory exhaustion DoS attacks. Affects discord.js HTTP client.                                                  |
| **Reason**            | discord.js 14.x is EOL; vulnerability only affects HTTP client in trusted API context (Discord). Fix requires discord.js v15 with ESM migration. Current threat model: minimal risk because we only connect to Discord's trusted API. |
| **Accepted By**       | Olav                                                                                                                                                                                                                                  |
| **Accepted Date**     | 2026-01-28                                                                                                                                                                                                                            |
| **Exemption Expires** | 2026-05-01                                                                                                                                                                                                                            |
| **Days Remaining**    | **92**                                                                                                                                                                                                                                |
| **Next Review**       | 2026-04-01                                                                                                                                                                                                                            |
| **Risk Level**        | MEDIUM-HIGH (mitigated by API context)                                                                                                                                                                                                |
| **Affected Packages** | discord.js@14.11.0                                                                                                                                                                                                                    |
| **Fix Available**     | Yes - discord.js@15.0.0+                                                                                                                                                                                                              |
| **Fix Effort**        | 22-35 hours (includes ESM conversion, builder imports, event handlers)                                                                                                                                                                |
| **Breaking Changes**  | Yes                                                                                                                                                                                                                                   |
| **Notes**             | Part of linked vulnerability group. All 4 instances are same CVE from discord.js dependency chain. CRITICAL: Must fix before 2026-05-01.                                                                                              |
| **Linked To**         | GHSA-6hxm-7r2w-pxwj (4 instances of same CVE)                                                                                                                                                                                         |

#### 2. GHSA-6hxm-7r2w-pxwj - undici

üî¥ **CRITICAL EXEMPTION**

| Property              | Value                                                           |
| --------------------- | --------------------------------------------------------------- |
| **CVE**               | GHSA-6hxm-7r2w-pxwj                                             |
| **Package**           | undici                                                          |
| **Severity**          | HIGH                                                            |
| **Status**            | ‚úÖ ACCEPTED                                                     |
| **Type**              | Decompression Bomb / Unbounded Decompression                    |
| **Description**       | Same as undici-decompression-1 (linked CVE, multiple instances) |
| **Reason**            | See undici-decompression-1                                      |
| **Accepted By**       | Olav                                                            |
| **Accepted Date**     | 2026-01-28                                                      |
| **Exemption Expires** | 2026-05-01                                                      |
| **Days Remaining**    | **92**                                                          |
| **Next Review**       | 2026-04-01                                                      |
| **Risk Level**        | MEDIUM-HIGH (mitigated by API context)                          |
| **Affected Packages** | discord.js@14.11.0                                              |
| **Fix Available**     | Yes - discord.js@15.0.0+                                        |
| **Fix Effort**        | 22-35 hours (grouped with other undici fixes)                   |
| **Breaking Changes**  | Yes                                                             |
| **Notes**             | Linked to undici-decompression-1. Part of same CVE group.       |
| **Linked To**         | GHSA-6hxm-7r2w-pxwj (instance 2 of 4)                           |

#### 3. GHSA-6hxm-7r2w-pxwj - undici

üî¥ **CRITICAL EXEMPTION**

| Property              | Value                                                           |
| --------------------- | --------------------------------------------------------------- |
| **CVE**               | GHSA-6hxm-7r2w-pxwj                                             |
| **Package**           | undici                                                          |
| **Severity**          | HIGH                                                            |
| **Status**            | ‚úÖ ACCEPTED                                                     |
| **Type**              | Decompression Bomb / Unbounded Decompression                    |
| **Description**       | Same as undici-decompression-1 (linked CVE, multiple instances) |
| **Reason**            | See undici-decompression-1                                      |
| **Accepted By**       | Olav                                                            |
| **Accepted Date**     | 2026-01-28                                                      |
| **Exemption Expires** | 2026-05-01                                                      |
| **Days Remaining**    | **92**                                                          |
| **Next Review**       | 2026-04-01                                                      |
| **Risk Level**        | MEDIUM-HIGH (mitigated by API context)                          |
| **Affected Packages** | discord.js@14.11.0                                              |
| **Fix Available**     | Yes - discord.js@15.0.0+                                        |
| **Fix Effort**        | 22-35 hours (grouped with other undici fixes)                   |
| **Breaking Changes**  | Yes                                                             |
| **Notes**             | Linked to undici-decompression-1 & 2. Part of same CVE group.   |
| **Linked To**         | GHSA-6hxm-7r2w-pxwj (instance 3 of 4)                           |

#### 4. GHSA-6hxm-7r2w-pxwj - undici

üî¥ **CRITICAL EXEMPTION**

| Property              | Value                                                                                                                        |
| --------------------- | ---------------------------------------------------------------------------------------------------------------------------- |
| **CVE**               | GHSA-6hxm-7r2w-pxwj                                                                                                          |
| **Package**           | undici                                                                                                                       |
| **Severity**          | HIGH                                                                                                                         |
| **Status**            | ‚úÖ ACCEPTED                                                                                                                  |
| **Type**              | Decompression Bomb / Unbounded Decompression                                                                                 |
| **Description**       | Same as undici-decompression-1 (linked CVE, multiple instances)                                                              |
| **Reason**            | See undici-decompression-1                                                                                                   |
| **Accepted By**       | Olav                                                                                                                         |
| **Accepted Date**     | 2026-01-28                                                                                                                   |
| **Exemption Expires** | 2026-05-01                                                                                                                   |
| **Days Remaining**    | **92**                                                                                                                       |
| **Next Review**       | 2026-04-01                                                                                                                   |
| **Risk Level**        | MEDIUM-HIGH (mitigated by API context)                                                                                       |
| **Affected Packages** | discord.js@14.11.0                                                                                                           |
| **Fix Available**     | Yes - discord.js@15.0.0+                                                                                                     |
| **Fix Effort**        | 22-35 hours (grouped with other undici fixes)                                                                                |
| **Breaking Changes**  | Yes                                                                                                                          |
| **Notes**             | Linked to undici-decompression-1, 2, & 3. FINAL instance of same CVE group. All 4 must be fixed together via discord.js v15. |
| **Linked To**         | GHSA-6hxm-7r2w-pxwj (instance 4 of 4)                                                                                        |

#### 5. GHSA-5j98-mcp5-4vw2 - glob

| Property              | Value                                                                                                                                                                                                                   |
| --------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **CVE**               | GHSA-5j98-mcp5-4vw2                                                                                                                                                                                                     |
| **Package**           | glob                                                                                                                                                                                                                    |
| **Severity**          | HIGH                                                                                                                                                                                                                    |
| **Status**            | ‚úÖ ACCEPTED                                                                                                                                                                                                             |
| **Type**              | Command Injection via glob pattern -c/--cmd options                                                                                                                                                                     |
| **Description**       | Glob package allows unvalidated shell metacharacters in patterns, enabling command injection when patterns are user-controlled. Affects @next/eslint-plugin-next via glob dependency.                                   |
| **Reason**            | glob is ONLY used in eslint configuration (build-time/dev-only). No runtime exposure. Dashboard is internal tooling, not production. Fix available: upgrade to latest @next/eslint-plugin-next which uses patched glob. |
| **Accepted By**       | Olav                                                                                                                                                                                                                    |
| **Accepted Date**     | 2026-01-28                                                                                                                                                                                                              |
| **Exemption Expires** | 2026-03-31                                                                                                                                                                                                              |
| **Days Remaining**    | **61**                                                                                                                                                                                                                  |
| **Next Review**       | 2026-03-01                                                                                                                                                                                                              |
| **Risk Level**        | LOW (build-time only, no runtime use)                                                                                                                                                                                   |
| **Affected Packages** | @next/eslint-plugin-next (via glob dependency)                                                                                                                                                                          |
| **Fix Available**     | Yes - @next/eslint-plugin-next@16.1.4+ (patches glob)                                                                                                                                                                   |
| **Fix Effort**        | 1-2 hours                                                                                                                                                                                                               |
| **Breaking Changes**  | No                                                                                                                                                                                                                      |
| **Notes**             | Easy fix available. Exemption expires 2026-03-31. Must upgrade before then.                                                                                                                                             |

### MODERATE Severity (3 vulnerabilities)

#### 6. GHSA-5p8v-58qm-c7m8 - tar

| Property              | Value                                                                                                                                                                                                   |
| --------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **CVE**               | GHSA-5p8v-58qm-c7m8                                                                                                                                                                                     |
| **Package**           | tar                                                                                                                                                                                                     |
| **Severity**          | MODERATE                                                                                                                                                                                                |
| **Status**            | ‚úÖ ACCEPTED                                                                                                                                                                                             |
| **Type**              | Symlink following / path traversal in tar extraction                                                                                                                                                    |
| **Description**       | Tar package doesn't properly validate symlink targets during extraction, allowing arbitrary file writes outside extraction directory. Transitive dependency of sqlite3 via node-gyp.                    |
| **Reason**            | tar is ONLY used during npm install via node-gyp (sqlite3 build). Never runs at runtime. Threat model: npm registry is trusted, node-gyp extraction is to isolated build cache. No production exposure. |
| **Accepted By**       | Olav                                                                                                                                                                                                    |
| **Accepted Date**     | 2026-01-28                                                                                                                                                                                              |
| **Exemption Expires** | 2026-05-31                                                                                                                                                                                              |
| **Days Remaining**    | **122**                                                                                                                                                                                                 |
| **Next Review**       | 2026-04-01                                                                                                                                                                                              |
| **Risk Level**        | LOW (build-time only)                                                                                                                                                                                   |
| **Affected Packages** | sqlite3@5.1.7 (via node-gyp build)                                                                                                                                                                      |
| **Fix Available**     | Yes - Automatic when sqlite3 rebuilds itself with patched tar                                                                                                                                           |
| **Fix Effort**        | 4-6 hours (rebuild sqlite3 in clean Docker environment)                                                                                                                                                 |
| **Breaking Changes**  | No                                                                                                                                                                                                      |
| **Notes**             | Build-time dependency only. Safe due to isolation and npm registry trust. Exemption expires 2026-05-31.                                                                                                 |
| **Linked To**         | GHSA-5p8v-58qm-c7m8 (3 instances from tar in node-gyp)                                                                                                                                                  |

#### 7. GHSA-5p8v-58qm-c7m8 - tar

| Property              | Value                                                                         |
| --------------------- | ----------------------------------------------------------------------------- |
| **CVE**               | GHSA-5p8v-58qm-c7m8                                                           |
| **Package**           | tar                                                                           |
| **Severity**          | MODERATE                                                                      |
| **Status**            | ‚úÖ ACCEPTED                                                                   |
| **Type**              | Symlink following / path traversal in tar extraction                          |
| **Description**       | Same as tar-vulnerability-1 (linked CVE, multiple instances from same source) |
| **Reason**            | See tar-vulnerability-1                                                       |
| **Accepted By**       | Olav                                                                          |
| **Accepted Date**     | 2026-01-28                                                                    |
| **Exemption Expires** | 2026-05-31                                                                    |
| **Days Remaining**    | **122**                                                                       |
| **Next Review**       | 2026-04-01                                                                    |
| **Risk Level**        | LOW (build-time only)                                                         |
| **Affected Packages** | sqlite3@5.1.7 (via node-gyp build)                                            |
| **Fix Available**     | Yes - Automatic when sqlite3 rebuilds itself with patched tar                 |
| **Fix Effort**        | 4-6 hours (grouped with other tar fixes)                                      |
| **Breaking Changes**  | No                                                                            |
| **Notes**             | Linked to tar-vulnerability-1. Part of same CVE group.                        |
| **Linked To**         | GHSA-5p8v-58qm-c7m8 (instance 2 of 3)                                         |

#### 8. GHSA-5p8v-58qm-c7m8 - tar

| Property              | Value                                                                         |
| --------------------- | ----------------------------------------------------------------------------- |
| **CVE**               | GHSA-5p8v-58qm-c7m8                                                           |
| **Package**           | tar                                                                           |
| **Severity**          | MODERATE                                                                      |
| **Status**            | ‚úÖ ACCEPTED                                                                   |
| **Type**              | Symlink following / path traversal in tar extraction                          |
| **Description**       | Same as tar-vulnerability-1 (linked CVE, multiple instances from same source) |
| **Reason**            | See tar-vulnerability-1                                                       |
| **Accepted By**       | Olav                                                                          |
| **Accepted Date**     | 2026-01-28                                                                    |
| **Exemption Expires** | 2026-05-31                                                                    |
| **Days Remaining**    | **122**                                                                       |
| **Next Review**       | 2026-04-01                                                                    |
| **Risk Level**        | LOW (build-time only)                                                         |
| **Affected Packages** | sqlite3@5.1.7 (via node-gyp build)                                            |
| **Fix Available**     | Yes - Automatic when sqlite3 rebuilds itself with patched tar                 |
| **Fix Effort**        | 4-6 hours (grouped with other tar fixes)                                      |
| **Breaking Changes**  | No                                                                            |
| **Notes**             | Linked to tar-vulnerability-1 & 2. FINAL instance of tar CVE from node-gyp.   |
| **Linked To**         | GHSA-5p8v-58qm-c7m8 (instance 3 of 3 - FINAL)                                 |

---

## Remediation Schedule

- **2026-03-31** (üü° 61 days): GHSA-5j98-mcp5-4vw2 - Upgrade to @next/eslint-plugin-next@16.1.4+ (patches glob)

---

## When Exemptions Are NO LONGER Valid

**If ANY of these conditions occur, exemptions are REVOKED:**

1. ‚ùå **Vulnerability is exploited in the wild**
   - Immediate action required
   - Exemption suspended
   - Emergency upgrade planned

2. ‚ùå **Feature becomes enabled/used**
   - Example: If dashboard goes to production with RSC
   - Exemption automatically expires
   - Must upgrade before activation

3. ‚ùå **Dependency is used in new context**
   - Example: If tar is used at runtime
   - Exemption void
   - Must fix immediately

4. ‚ùå **Re-evaluation date passes without renewal**
   - Exemption expires automatically
   - Workflow fails until resolved
   - Blocks all CI/CD
5. ‚ùå **Baseline expiration date reached**
   - All exemptions expire on baseline.expiresAt date
   - Baseline must be renewed or all exemptions revoked

---

## Related Resources

- [VULNERABILITY-ACCEPTANCE-STRATEGY.md](.github/VULNERABILITY-ACCEPTANCE-STRATEGY.md) - Acceptance policy & philosophy
- [audit-baseline.json](.github/audit-baseline.json) - Machine-readable source of truth
- [security.yml](.github/workflows/security.yml) - Workflow that checks against baseline
- [compare-audit-against-baseline.sh](./scripts/compare-audit-against-baseline.sh) - Validation script

---

**Auto-Generated From**: [.github/audit-baseline.json](.github/audit-baseline.json)

**Last Generated**: 2026-01-29T12:32:42.086Z

**To Regenerate**: `npm run sync:vulnerabilities`
